import React from "react";
import PropTypes from "prop-types";
import { useSaved } from "../../context/saved-context";

function JobCard({ job }) {
  const { saved, setSaved } = useSaved();
  let ids = [];
  if (saved) {
    ids = saved.map(({ id }) => id);
  }
  const isSaved = ids.includes(job.id);

  function saveJob() {
    if (!isSaved) {
      setSaved((prev) => [...prev, job]);
    }
  }

  function removeJob() {
    if (isSaved) {
      setSaved(saved.filter(({ id }) => id !== job.id));
    }
  }

  if (isSaved) {
    return (
      <button
        className="save-button-card remove-job"
        type="button"
        onClick={() => {
          removeJob();
        }}
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9.80497 9L12.235 6.57C12.3169 6.47435 12.3597 6.35131 12.3548 6.22547C12.35 6.09964 12.2978 5.98027 12.2087 5.89122C12.1197 5.80217 12.0003 5.75 11.8745 5.74514C11.7487 5.74028 11.6256 5.78309 11.53 5.865L9.09997 8.27L6.65497 5.825C6.55932 5.74309 6.43628 5.70028 6.31044 5.70514C6.1846 5.71 6.06523 5.76217 5.97619 5.85122C5.88714 5.94027 5.83497 6.05964 5.83011 6.18547C5.82525 6.31131 5.86805 6.43435 5.94997 6.53L8.38997 9L5.99997 11.36C5.94763 11.4048 5.90512 11.46 5.8751 11.522C5.84509 11.584 5.82823 11.6516 5.82557 11.7205C5.82291 11.7893 5.83451 11.858 5.85965 11.9222C5.88479 11.9863 5.92291 12.0446 5.97164 12.0933C6.02037 12.1421 6.07864 12.1802 6.14281 12.2053C6.20697 12.2305 6.27563 12.2421 6.34449 12.2394C6.41335 12.2367 6.48092 12.2199 6.54295 12.1899C6.60498 12.1599 6.66014 12.1173 6.70497 12.065L9.08997 9.68L11.46 12.05C11.5556 12.1319 11.6787 12.1747 11.8045 12.1699C11.9303 12.165 12.0497 12.1128 12.1387 12.0238C12.2278 11.9347 12.28 11.8154 12.2848 11.6895C12.2897 11.5637 12.2469 11.4407 12.165 11.345L9.80497 9Z"
            fill="white"
          />
          <path
            d="M9 17C7.41775 17 5.87103 16.5308 4.55544 15.6518C3.23985 14.7727 2.21447 13.5233 1.60897 12.0615C1.00347 10.5997 0.84504 8.99113 1.15372 7.43928C1.4624 5.88743 2.22433 4.46197 3.34315 3.34315C4.46197 2.22433 5.88743 1.4624 7.43928 1.15372C8.99113 0.845036 10.5997 1.00346 12.0615 1.60896C13.5233 2.21447 14.7727 3.23985 15.6518 4.55544C16.5308 5.87103 17 7.41775 17 9C17 11.1217 16.1571 13.1566 14.6569 14.6569C13.1566 16.1571 11.1217 17 9 17V17ZM9 2C7.61553 2 6.26216 2.41054 5.11101 3.17971C3.95987 3.94888 3.06266 5.04213 2.53285 6.32122C2.00303 7.6003 1.86441 9.00777 2.13451 10.3656C2.4046 11.7235 3.07129 12.9708 4.05026 13.9497C5.02922 14.9287 6.2765 15.5954 7.63437 15.8655C8.99224 16.1356 10.3997 15.997 11.6788 15.4672C12.9579 14.9373 14.0511 14.0401 14.8203 12.889C15.5895 11.7378 16 10.3845 16 9C16 7.14349 15.2625 5.36301 13.9498 4.05025C12.637 2.7375 10.8565 2 9 2V2Z"
            fill="white"
          />
        </svg>
        <p>Unsave Job</p>
      </button>
    );
  }
  return (
    <button
      className="save-button-card"
      type="button"
      onClick={() => {
        saveJob();
      }}
    >
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M20.496 5.627C20.9357 5.78152 21.3166 6.06877 21.586 6.44907C21.8554 6.82937 22.0001 7.28394 22 7.75V17.75C22 18.8772 21.5522 19.9582 20.7552 20.7552C19.9582 21.5522 18.8772 22 17.75 22H7.75C7.28394 22.0001 6.82937 21.8554 6.44907 21.586C6.06877 21.3166 5.78152 20.9357 5.627 20.496L7.724 20.5H17.75C18.4793 20.5 19.1788 20.2103 19.6945 19.6945C20.2103 19.1788 20.5 18.4793 20.5 17.75V7.75L20.496 7.699V5.627ZM17.246 2C17.8427 2 18.415 2.23705 18.837 2.65901C19.2589 3.08097 19.496 3.65326 19.496 4.25V17.247C19.496 17.8437 19.2589 18.416 18.837 18.838C18.415 19.2599 17.8427 19.497 17.246 19.497H4.25C3.65326 19.497 3.08097 19.2599 2.65901 18.838C2.23705 18.416 2 17.8437 2 17.247V4.25C2 3.65326 2.23705 3.08097 2.65901 2.65901C3.08097 2.23705 3.65326 2 4.25 2H17.247H17.246ZM17.246 3.5H4.25C4.05109 3.5 3.86032 3.57902 3.71967 3.71967C3.57902 3.86032 3.5 4.05109 3.5 4.25V17.247C3.5 17.661 3.836 17.997 4.25 17.997H17.247C17.4459 17.997 17.6367 17.918 17.7773 17.7773C17.918 17.6367 17.997 17.4459 17.997 17.247V4.25C17.997 4.05109 17.918 3.86032 17.7773 3.71967C17.6367 3.57902 17.4459 3.5 17.247 3.5H17.246ZM10.75 6.75C10.9489 6.75 11.1397 6.82902 11.2803 6.96967C11.421 7.11032 11.5 7.30109 11.5 7.5V10H14C14.1989 10 14.3897 10.079 14.5303 10.2197C14.671 10.3603 14.75 10.5511 14.75 10.75C14.75 10.9489 14.671 11.1397 14.5303 11.2803C14.3897 11.421 14.1989 11.5 14 11.5H11.5V14C11.5 14.1989 11.421 14.3897 11.2803 14.5303C11.1397 14.671 10.9489 14.75 10.75 14.75C10.5511 14.75 10.3603 14.671 10.2197 14.5303C10.079 14.3897 10 14.1989 10 14V11.5H7.5C7.30109 11.5 7.11032 11.421 6.96967 11.2803C6.82902 11.1397 6.75 10.9489 6.75 10.75C6.75 10.5511 6.82902 10.3603 6.96967 10.2197C7.11032 10.079 7.30109 10 7.5 10H10V7.5C10 7.30109 10.079 7.11032 10.2197 6.96967C10.3603 6.82902 10.5511 6.75 10.75 6.75Z"
          fill="#C8C8C8"
        />
      </svg>
      <p>Save Job</p>
    </button>
  );
}

JobCard.propTypes = {
  job: PropTypes.shape({
    title: PropTypes.node,
    content: PropTypes.node,
    id: PropTypes.node,
  }).isRequired,
};

export default JobCard;
